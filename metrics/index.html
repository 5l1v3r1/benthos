<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="None">
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Benthos</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body class="homepage">

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">Benthos</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="/">Home</a>
                            </li>
                            <li >
                                <a href="../concepts/">Concepts</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Components <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../inputs">Inputs</a>
</li>
                                    
<li >
    <a href="../buffers">Buffers</a>
</li>
                                    
<li >
    <a href="../processors">Processors</a>
</li>
                                    
<li >
    <a href="../conditions">Conditions</a>
</li>
                                    
<li >
    <a href="../outputs">Outputs</a>
</li>
                                    
<li >
    <a href="../caches">Caches</a>
</li>
                                    
<li >
    <a href="../rate_limits">Rate Limits</a>
</li>
                                    
<li >
    <a href=".">Metrics</a>
</li>
                                    
<li >
    <a href="../tracers">Tracers</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Guides <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../getting_started/">Getting Started</a>
</li>
                                    
<li >
    <a href="../pipeline/">Pipeline</a>
</li>
                                    
<li >
    <a href="../batching/">Message Batching</a>
</li>
                                    
<li >
    <a href="../error_handling/">Error Handling</a>
</li>
                                    
<li >
    <a href="../workflows/">Workflows</a>
</li>
                                    
<li >
    <a href="../configuration/">Config Cheats</a>
</li>
                                    
<li >
    <a href="../config_interpolation/">Config Interpolation</a>
</li>
                                    
<li >
    <a href="../examples">Interesting Examples</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#metric-target-types">Metric Target Types</a></li>
            <li><a href="#blacklist">blacklist</a></li>
            <li><a href="#http_server">http_server</a></li>
            <li><a href="#prometheus">prometheus</a></li>
            <li><a href="#rename">rename</a></li>
            <li><a href="#statsd">statsd</a></li>
            <li><a href="#whitelist">whitelist</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="metric-target-types">Metric Target Types</h1>
<p>This document was generated with <code>benthos --list-metrics</code></p>
<p>A metrics type represents a destination for Benthos metrics to be aggregated
such as Statsd, Prometheus, or for debugging purposes an HTTP endpoint that
exposes a JSON object of metrics.</p>
<p>Benthos exposes lots of metrics and their paths will depend on your pipeline
configuration. However, there are some critical metrics that will always be
present that are outlined in <a href="paths/">this document</a>.</p>
<h2 id="blacklist"><code>blacklist</code></h2>
<pre><code class="yaml">type: blacklist
blacklist:
  child: {}
  paths: []
  patterns: []
prefix: benthos
</code></pre>

<p>Blacklist metric paths within Benthos so that they are not aggregated by a child
metric target.</p>
<p>Blacklists can either be path prefixes or regular expression patterns, if either
a path prefix or regular expression matches a metric path it will be excluded.</p>
<p>Metrics must be matched using dot notation even if the chosen output uses a
different form. For example, the path would be 'foo.bar' rather than 'foo_bar'
even when sending metrics to Prometheus.</p>
<p>The <code>prefix</code> field in a metrics config is ignored by this type. Please
configure a prefix at the child level.</p>
<h3 id="paths">Paths</h3>
<p>An entry in the <code>paths</code> field will check using prefix matching. This
can be used, for example, to allow none of the child specific metrics paths from
an output broker with the path <code>output.broker</code>.</p>
<h3 id="patterns">Patterns</h3>
<p>An entry in the <code>patterns</code> field will be parsed as an RE2 regular
expression and tested against each metric path. This can be used, for example,
to allow none of the latency based metrics with the pattern
<code>.*\.latency</code>.</p>
<h2 id="http_server"><code>http_server</code></h2>
<pre><code class="yaml">type: http_server
http_server: {}
prefix: benthos
</code></pre>

<p>It is possible to expose metrics without an aggregator service by having Benthos
serve them as a JSON object at the endpoints <code>/stats</code> and <code>/metrics</code>.
This is useful for quickly debugging a pipeline.</p>
<p>The object takes the form of a hierarchical representation of the dot paths for
each metric combined. So, for example, if Benthos exposed two metric counters
<code>foo.bar</code> and <code>bar.baz</code> then the resulting object might look like
this:</p>
<pre><code class="json">{
    &quot;foo&quot;: {
        &quot;bar&quot;: 9
    },
    &quot;bar&quot;: {
        &quot;baz&quot;: 3
    }
}
</code></pre>

<h2 id="prometheus"><code>prometheus</code></h2>
<pre><code class="yaml">type: prometheus
prefix: benthos
prometheus:
  push_interval: &quot;&quot;
  push_job_name: benthos_push
  push_url: &quot;&quot;
</code></pre>

<p>Host endpoints (<code>/metrics</code> and <code>/stats</code>) for Prometheus scraping.
Metrics paths will differ from <a href="paths/">the list</a> in that dot separators will
instead be underscores.</p>
<h3 id="push-gateway">Push Gateway</h3>
<p>The field <code>push_url</code> is optional and when set will trigger a push of
metrics to a <a href="https://prometheus.io/docs/instrumenting/pushing/">Prometheus Push Gateway</a>
once Benthos shuts down. It is also possible to specify a
<code>push_interval</code> which results in periodic pushes.</p>
<p>The Push Gateway This is useful for when Benthos instances are short lived. Do
not include the "/metrics/jobs/..." path in the push URL.</p>
<h2 id="rename"><code>rename</code></h2>
<pre><code class="yaml">type: rename
prefix: benthos
rename:
  by_regexp: []
  child: {}
</code></pre>

<p>Rename metric paths as they are registered.</p>
<p>Metrics must be matched using dot notation even if the chosen output uses a
different form. For example, the path would be 'foo.bar' rather than 'foo_bar'
even when sending metrics to Prometheus.</p>
<p>The <code>prefix</code> field in a metrics config is ignored by this type. Please
configure a prefix at the child level.</p>
<h3 id="by_regexp"><code>by_regexp</code></h3>
<p>An array of objects of the form <code>{"pattern":"foo","value":"bar"}</code>
where each pattern will be parsed as RE2 regular expressions, these expressions
are tested against each metric path, where all occurrences will be replaced with
the specified value. Inside the value $ signs are interpreted as submatch
expansions, e.g. $1 represents the first submatch.</p>
<p>To replace the paths 'foo.bar.zap' and 'foo.baz.zap' with 'zip.bar' and
'zip.baz' respectively we could use this config:</p>
<pre><code class="yaml">type: rename
rename:
  by_regexp:
  - pattern: &quot;foo\\.([a-z]*)\\.zap&quot;
    value: &quot;zip.$1&quot;
</code></pre>

<h2 id="statsd"><code>statsd</code></h2>
<pre><code class="yaml">type: statsd
prefix: benthos
statsd:
  address: localhost:4040
  flush_period: 100ms
  network: udp
</code></pre>

<p>Push metrics over a TCP or UDP connection using the
<a href="https://github.com/statsd/statsd">StatsD protocol</a>.</p>
<h2 id="whitelist"><code>whitelist</code></h2>
<pre><code class="yaml">type: whitelist
prefix: benthos
whitelist:
  child: {}
  paths: []
  patterns: []
</code></pre>

<p>Whitelist metric paths within Benthos so that only matching metric paths are
aggregated by a child metric target.</p>
<p>Whitelists can either be path prefixes or regular expression patterns, if either
a path prefix or regular expression matches a metric path it will be included.</p>
<p>Metrics must be matched using dot notation even if the chosen output uses a
different form. For example, the path would be 'foo.bar' rather than 'foo_bar'
even when sending metrics to Prometheus.</p>
<p>The <code>prefix</code> field in a metrics config is ignored by this type. Please
configure a prefix at the child level.</p>
<h3 id="paths_1">Paths</h3>
<p>An entry in the <code>paths</code> field will check using prefix matching. This
can be used, for example, to allow the child specific metrics paths from an
output broker with the path <code>output.broker</code>.</p>
<h3 id="patterns_1">Patterns</h3>
<p>An entry in the <code>patterns</code> field will be parsed as an RE2 regular
expression and tested against each metric path. This can be used, for example,
to allow all latency based metrics with the pattern <code>.*\.latency</code>.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.0.4
Build Date UTC : 2019-03-14 11:14:49
-->
